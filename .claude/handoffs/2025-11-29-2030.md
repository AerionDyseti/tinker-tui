# Handoff - Tinker

**Date:** 2025-11-29 20:30 | **Branch:** master

## Summary

Major naming refactor in progress: SessionEntry → SessionArtifact, ConversationService → ActiveSession. Also pivoted from TUI to React web frontend. Most files updated, but persistence layer (schema.ts, project-storage.ts) still needs work.

## Completed

- Created `src/domain/artifact.ts` with new SessionArtifact types
- Split ToolInvocation into separate ToolUse and ToolResult
- Added CompletionStatus ("complete" | "token_limit" | "user_interrupted")
- Added provider/model/status fields to AgentResponse
- Created `src/application/active-session.ts` (replaces ConversationService)
- Updated domain layer: context.ts, provider.ts, session.ts
- Updated infrastructure: assembler.ts, debug.ts, openrouter.ts
- Updated web server to use ActiveSession
- Removed TUI code, solid-js dependencies
- Web frontend spike working (React + Bun.serve())

## In Progress

- Persistence layer refactor:
  - `schema.ts` - rename messagesSchema → artifactsSchema
  - `project-storage.ts` - extensive changes for new types

## Blocked

- None

## Next

1. Update `src/infrastructure/persistence/schema.ts` - rename messagesSchema to artifactsSchema
2. Update `src/infrastructure/persistence/project-storage.ts`:
   - Rename entry→artifact in all functions/types
   - Handle ToolUse/ToolResult split (was single ToolInvocation)
   - Add provider/model/status serialization for AgentResponse
3. Run `bun test` and `bun run typecheck`
4. Commit naming refactor
5. **Configure per-project storage for serena and vector-memory** - Currently memories are stored globally in `~/.local/share/`. Need to configure both MCP servers to use project-local storage so we can sync memories between desktop (Krypton) and laptop without conflicts or data loss.

## Files

- `memories.tar.gz` - Archive of all vector-memory-mcp memories from Krypton (desktop). Contains the full `~/.local/share/vector-memory-mcp/memories.db` Lance database.

## Memory IDs

- d0cac76d-4399-4c4e-86a5-b1109d63c0d5 (decision: naming refactor)
- 14b22cf3-92e5-47fb-96c8-603d84d476e5 (decision: web pivot)
- a5c301e1-5ccb-488c-a2cb-92842f0b31ad (implementation: files changed)
- 543237ef-e0f5-42bb-b6da-f292bc497cf2 (next-step: persistence layer)
- 8cd04644-3b95-44b5-8da9-20a4fc493ac2 (insight: domain types for UI apps)
